---
title: "STATS 201/8 Assignment 2"
author: "Sophie Jones 224910734"
date: 'Due Date: 3pm, Tuesday 25th March 2025'
output:
  html_document:
    fig_caption: yes
    number_sections: yes
  pdf_document:
    number_sections: yes
  word_document:
    number_sections: yes
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.height=3)
```

```{r setup, echo=FALSE,warning=FALSE}
## Do not delete this!
## It loads the s20x library for you. If you delete it 
## your document may not compile
library(s20x)
```

# Question 1 [10 Marks]

The manager at a large organisation is investigating using AI to assist customers filling in feedback forms to see if they can be filled in faster and help streamline gathering information. The company has developed an improved version of their current feedback form using AI assistants. They trial this over a few weeks and randomly select 100 of the forms filled in and recorded the times that were taken to complete them. Statistics for the previous form (used for the past five years) have established that the mean time taken to fill in the old feedback form was 14.4 minutes. The manager wants to know if there is any evidence of that the mean time to fill in new form is faster and, if so, how big is the difference?

The data is in the file *Feedback.csv*, which contains the variables:

| Variable | Description |
|------------------------------------|------------------------------------|
| Time | The time that a customer took to fill in the feedback form (in minutes), |

**Instructions:**

-   Make sure you change your name and UPI/ID number at the top of the assignment.
-   The data is moderately skewed. Why are we still able to carry out a t-test on the mean on this data?
-   Instead of the default hypothesis test in R commands of mu=0, what value should we be comparing the underlying mean Time to?
-   Use R-code to manually calculate the t-statistic and 95% confidence interval for the appropriate t-test.
-   Write an appropriate **Executive Summary**. Note: carefully read the question of interest.

## Question of interest/goal of the study

We are interested in seeing if there is any evidence of that the mean time to fill in new feedback form is faster than that of the old feedback form and, if so, how big is the difference?

## Read in and inspect the data:

```{r,fig.height=4.2,fig.width=6}
Feedback.df=read.csv("Feedback.csv", header=T)
Time=Feedback.df$Time
boxplot(Time, horizontal = TRUE,main="Feedback times")
summary(Time)
```

## Comment on the plot/exploratory data analysis (done for you)

The average times are below 14 with a median time of 10.3 and a mean time of 11.7. The data is moderately positively (right) skewed. Most times are under 14 minutes, with under a quarter of times longer than this.

## The data is moderately skewed. Why are we still able to carry out a t-test on the mean on this data?

The purpose of a t-test is to determine if there is statically significant difference between two groups. Normally, the t-test assumes that the data's mean is normally distributed. This is not the case with this data set as the data is moderately skewed. However, we can still carry out a t-test due to the Central Limit Theorem. The CLT states that provided we have a large enough sample, the sampling distribution of the mean will be approximately normal, despite the data being moderately skewed. For CLT a sample size is classified as large enough when it is n ≥ 30. Since, our sample size is 100, it is therefore large enough to ensure the validity of a t-test. Therefore, we are still able to carry out a t-test on the mean on this data.

## Instead of the default hypothesis test in R commands of mu=0, what value should we be comparing the underlying mean Time to?

The value we should use when comparing the underlying mean time to should be 14.4 mins. This is because in a one sample test, we compare the sample mean to the null hypothesis (µ0). The null hypothesis represents a benchmark for what we are testing against. In this situation, the organisation wants to determine if their new AI assisting feedback increases the time of completion. They are doing this in comparison to the old feedback form which had a mean completion time of 14.4 mins. Therefore, the value we should be comparing the underlying mean time to should be 14.4 mins.

## Use R-code to manually calculate the t-statistic and 95% confidence interval for the appropriate t-test.

Formulas: $T = \frac{\bar{y}-\mu_0}{se(\bar{y})}$ and 95% confidence interval $\bar{y} \pm t_{df, 0.975} \times se(\bar{y})$

NOTES: The R code `mean(y)` calculates $\bar{y}$. The standard error is $se(\bar{y}) = \frac{s}{\sqrt{n}}$ where $s$ is the standard deviation of $y$ and is calculated by `sd(y)`, and $n$ is the number of data-points calculated by `length(y)`. The degrees of freedom is $df = n-1$. The $t_{df,0.975}$ multiplier is given by the R code `qt(0.975, df)`.

```{r}


# t-statistic for H0: mu=14.4:
my_data <- read.csv("Feedback.csv")
y <- my_data$Time
n = length(y) 
tstat = (mean(y) - 14.4)/(sd(y)/sqrt(n))
tstat

# 95% confidence interval for the mean:

tmult = qt(1-0.5/2, df=n-1)
mean(y) - tmult*sd(y)/sqrt(n)
mean(y) + c(-1,1)*tmult*sd(y)/sqrt(n)

```

## Repeat the same calculation using the t.test function (done for you):

```{r}
t.test(Time,mu=14.4)
```

**Note:** You should get exactly the same results from the manual calculations and using the $t.test$ function. Doing this was to give you practice using some R code. The $t.test$ function also delivers the p-value that we did not calculate above.

## Fit and check the null model (done for you):

```{r}
Feedback.lm=lm(Time~1)
normcheck(Feedback.lm)
cooks20x(Feedback.lm)
summary(Feedback.lm)
confint(Feedback.lm)
14.4-confint(Feedback.lm)
```

## Method and Assumption Checks (done for you)

These data come from a random sample of 100 customers feedback forms. As it is a single quantitative variable, we have fitted a null linear model - a one sample t-test and confidence interval. The time distribution is moderately right skewed, but as discussed above, we can still rely on our analysis. We have independence from taking a random sample and there are no unduly influential points.

Our preferred model is:

Our model is: $Time_i = \mu + \epsilon_i$ where $\epsilon_i \sim iid ~ N(0,\sigma^2)$

and $\mu$ is the average time customers take to fill in the new feedback form.

## Write an appropriate **Executive Summary**. Note: carefully read the question of interest.

We are interested in evaluating whether the mean time to fill in the new AI assisting feedback form is faster than the old feedback form. In particular, we wish to see if there is a big difference between the two mean times.

We have strong evidence that the new AI assisted feedback form mean time is faster than the old feedback form.

With 95% confidence the mean for the new feedback form is likely to be between 11.5 and 12.0 mins faster than the old feedback form. The confidence interval also does not include 14.4 mins therefore I can make the call that the new feedback form is faster. Thus, the mean time to fill in the new feedback form is faster than the old feedback form.

------------------------------------------------------------------------

# Question 2 [16 Marks]

Researchers measured the carapace (shell) length (in mm) of 18 female gopher tortoises in Florida, and X-rayed them to count the number of eggs each tortoise carried. They were interested in predicting the number of eggs based on the tortoise’s carapace length. In particular, they wanted to know if the collected data was useful for predicting the number of eggs when the length of a female gopher tortoise is 310mm.

Note: tortoise’s carapaces get longer as the tortoise ages.

The data is in the file *tortoises.csv*, which contains the variables:

| Variable | Description                                                     |
|------------------|------------------------------------------------------|
| Length   | The carapace (shell) length (in mm) of female gopher tortoises, |
| Number   | The number of eggs in each female gopher tortoise.              |

**Instructions:**

-   Comment on the plot of the data.
-   Fit an appropriate linear model, including model checks.
-   Plot the data with your appropriate model superimposed over it.
-   Use your model to get an interval predicting the number of eggs when the length of a female gopher tortoises carapace is 310mm.
-   Write appropriate Methods and Assumption Checks.
-   Write an Executive Summary, including a sentence interpreting the requested prediction interval.

## Question of interest/goal of the study

We are interested in predicting the number of eggs based on the female gopher tortoise's carapace (shell) length.

## Read in and inspect the data:

```{r,fig.height=5,fig.width=6}
Tortoise.df=read.csv("tortoises.csv",header=T)
plot(Number~Length,data=Tortoise.df)
```

## Comment on the plot

The scatter plot suggests a weak negative relationship between the two variables. However, it is not quite a straight line which could be some curvature with the number of tortoise eggs increasing with the carapace length. Therefore, a simple linear model may not be appropriate for this model.

## Fit an appropriate linear model, including model checks.

```{r,fig.height=5,fig.width=6}

carapacelength.fit <-  lm(Number ~ Length, data = Tortoise.df)
modelcheck(carapacelength.fit)

summary(carapacelength.fit)

confint(carapacelength.fit)

```

## Plot the data with your appropriate model superimposed over it.

```{r,fig.height=3.5,fig.width=6}

carapacelength.fit2 <- lm(Number ~ Length + I(Length^2), data = Tortoise.df)
plot(carapacelength.fit2,which=1)

x <- seq(min(Tortoise.df$Length), max(Tortoise.df$Length), length.out = 100)

predict_data <-  data.frame(Length = x, Length2 = x^2)
predictN <- predict(carapacelength.fit2, newdata = predict_data)

plot(Number ~ Length, data = Tortoise.df, main = "Curve Fit")
lines(x, predictN, col = "pink", lwd = 2)

summary(carapacelength.fit2)
```

## Use your model to get an interval predicting the number of eggs when the length of a female gopher tortoises carapace is 310mm.

```{r}
predLength.df = data.frame(Length = c(310))
predict(carapacelength.fit2, predLength.df, interval = "confidence")



```

## Write appropriate Methods and Assumption Checks.

The scatter plot of the carapace length of the female tortoises and the number of eggs each tortoises carried suggested curvature in the relationship.

I began with a linear model to describe the carapace length with the number of eggs. The residual plot from the fit of a simple linear model showed fairly constant scatter but also had strong curvature. So a quadratic term was added to the linear model.

All model assumptions look satisfied once we added the quadratic term to the linear model.

Our final model is:

numbereggsi=β0+β1×carapacelengthi+ϵi where 𝜖𝑖∼𝑖𝑖𝑑 𝑁(0,𝜎2)

Our model explained 79% of the variability in the tortoise's number of eggs carried.

## Write an Executive Summary, including a sentence interpreting the requested prediction interval.

We were interested in predicting the number of eggs based on the female gopher tortoise's carapace (shell) length.

The relationship between the number of eggs and the carapace length was quadratic.

For a female gopher tortoise's carapace being 310mm in length, the estimated number of eggs that tortoise would carried was between 9 to 11 eggs, respectively.
